# アップストリームアーカイブノードの設定アップストリームEN

アップストリームEN（エンドポイントノード）機能により、フルノードオペレーターはアーカイブノードをRPCフォールバックとして利用することができる。 フル・ノードとアーカイブ・ノードの詳細については、[ブロック同期](../../learn/storage/block-sync.md)のページを参照してください。

フルノードが`missing trie node`エラーを返そうとしているとき、指定された上流のRPC URLを呼び出し、その結果を返そうとする。 アーカイブノードをアップストリームとして構成した場合、フルノードは基本的にアーカイブノードの負荷を最小限に抑えながら、アーカイブグレードのサービスを提供します。

## 使用方法

アップストリームEN機能を使用することで、費用対効果の高いアーカイブRPCサービスを運用することができます。 1つのアーカイブノードを実行し、多くのフルノードを実行する。 フルノードをアーカイブノードにフォールバックさせる。 このようにして、ほとんどのリクエストはフルノードが処理し、歴史的な状態を必要とする一部のリクエストはアーカイブノードが処理する。

<p align="center"><img src="/img/learn/upstream_en.png" width="50%"/></p>

## アップストリームENを有効にする方法

アップストリームEN機能を使うには、フルノードに `--upstream-en<RPC_URL>` フラグを渡すだけでよい。 例えば、`kend.conf` ファイルに記述します、

```sh
ADDITIONAL="$ADDITIONAL --upstream-en https://archive-en.node.kaia.io"
```