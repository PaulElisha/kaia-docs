# v1.8.0

## 軟件包下載

### 轉速<a id="rpm"></a>

賽普拉斯套餐

- [kcnd-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kcnd-v1.8.0-0.el7.x86_64.rpm)
- [kpnd-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kpnd-v1.8.0-0.el7.x86_64.rpm)
- [kend-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kend-v1.8.0-0.el7.x86_64.rpm)

猴麵包樹套餐

- [kcnd-baobab-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kcnd-baobab-v1.8.0-0.el7.x86_64.rpm)
- [kpnd-baobab-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kpnd-baobab-v1.8.0-0.el7.x86_64.rpm)
- [kend-baobab-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kend-baobab-v1.8.0-0.el7.x86_64.rpm)

通用軟件包

- [kscnd-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kscnd-v1.8.0-0.el7.x86_64.rpm)
- [kspnd-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kspnd-v1.8.0-0.el7.x86_64.rpm)
- [ksend-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/ksend-v1.8.0-0.el7.x86_64.rpm)
- [kbnd-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kbnd-v1.8.0-0.el7.x86_64.rpm)
- [kgen-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/kgen-v1.8.0-0.el7.x86_64.rpm)
- [homi-v1.8.0-0.el7.x86_64.rpm](https://packages.klaytn.net/klaytn/v1.8.0/homi-v1.8.0-0.el7.x86_64.rpm)

### 利納克斯<a id="linux"></a>

賽普拉斯套餐

- [kcn-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kcn-v1.8.0-0-linux-amd64.tar.gz)
- [kpn-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kpn-v1.8.0-0-linux-amd64.tar.gz)
- [ken-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/ken-v1.8.0-0-linux-amd64.tar.gz)

猴麵包樹套餐

- [kcn-baobab-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kcn-baobab-v1.8.0-0-linux-amd64.tar.gz)
- [kpn-baobab-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kpn-baobab-v1.8.0-0-linux-amd64.tar.gz)
- [ken-baobab-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/ken-baobab-v1.8.0-0-linux-amd64.tar.gz)

通用軟件包

- [kscn-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kscn-v1.8.0-0-linux-amd64.tar.gz)
- [kspn-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kspn-v1.8.0-0-linux-amd64.tar.gz)
- [ksen-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/ksen-v1.8.0-0-linux-amd64.tar.gz)
- [kbn-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kbn-v1.8.0-0-linux-amd64.tar.gz)
- [kgen-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kgen-v1.8.0-0-linux-amd64.tar.gz)
- [homi-v1.8.0-0-linux-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/homi-v1.8.0-0-linux-amd64.tar.gz)

### MacOS<a id="macos"></a>

賽普拉斯套餐

- [kcn-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kcn-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [kpn-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kpn-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [ken-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/ken-v1.8.0-0-darwin-10.10-amd64.tar.gz)

猴麵包樹套餐

- [kcn-baobab-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kcn-baobab-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [kpn-baobab-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kpn-baobab-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [ken-baobab-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/ken-baobab-v1.8.0-0-darwin-10.10-amd64.tar.gz)

通用軟件包

- [kscn-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kscn-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [kspn-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kspn-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [ksen-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/ksen-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [kbn-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kbn-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [kgen-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/kgen-v1.8.0-0-darwin-10.10-amd64.tar.gz)
- [homi-v1.8.0-0-darwin-10.10-amd64.tar.gz](https://packages.klaytn.net/klaytn/v1.8.0/homi-v1.8.0-0-darwin-10.10-amd64.tar.gz)

### 視窗<a id="windows"></a>

- 尚未支持

## 發佈說明

Klaytn v1.8.0 包含協議升級，這將導致不兼容的變化，如以太坊硬分叉。 所有節點都需要在目標塊編號之前升級到該版本。

計劃的硬分叉時間表如下

- Baobab 測試網（Baobab 區塊編號 86513895，計劃日期：3 月 24 日）
 - EthTxType 硬分叉：#86513895
  （Baobab 上已經應用了伊斯坦布爾 EVM 和倫敦 EVM 硬分叉）

- 賽普拉斯主網（賽普拉斯區塊編號 86816005，計劃日期：3 月 31 日）
 - 伊斯坦布爾 EVM 硬分叉：#86816005
 - LondonEVM 硬分叉：#86816005
 - EthTxType 硬分叉：#86816005

**注意：伊斯坦布爾 EVM 硬分叉包括 EVM 操作碼的氣體成本變化以及如何使用 API 的變化。 由於這些更改，現有合同可能無法按預期運行，因此請參閱本文的[協議更新注意事項]部分**。

## 協議升級功能

- 引入 EthTxType 硬分叉，使新的交易類型能夠支持以太坊交易類型：TxTypeEthereumAccessList "和 "TxTypeEthereumDynamicFee"（#1142 #1158）

## v1.8.0 中的新功能

- 定義了 `EthereumTxTypeEnvelope` (#1171)
- 為新交易類型實施 EIP-2930 簽名器和倫敦簽名器 (#1142 #1158)
- 引入了 `eth` 命名空間 API 以支持以太坊 API 格式（#1076 #1077 #1083 #1088 #1093 #1095 #1121 #1123 #1124 #1127 #1129 #1130 #1134 #1172）
- 添加了新的 `klay` 命名空間 API：klay_maxPriorityFeePerGas`、`klay_createAccessList`和`klay_feeHistory\` (#1156)
- 引入`rpc.eth.noncompatible`標記，禁用以太坊應用程序接口格式兼容性（#1072）
- 在塊標頭 API 返回值中添加了 "baseFeePerGas "字段 (#1183)
- 已執行狀態快照（#1112 #1116 #1152 #1154 #1155 #1173 #1174）
- 實現了自動重啟守護進程以防崩潰 (#1101)

### 改進

- 調整了節點啟動時帳戶管理器的解鎖時間 (#1141)
- 允許在一次投票中添加/刪除多個驗證器 (#1110)
- 增強了治理投票 API 的驗證邏輯 (#1109)
- 統一 blockchain.go 中的互斥 (#1099)

### 修復

- 修正了一個治理緩存初始化錯誤 (#1168)
- 修正了 `klay_gasPrice` API，使其返回正確的Gas 價格值 (#1211)
- 修復了事務字段更新引發的競賽條件問題 (#1091)
- 修正了深度返回對象引起的調用跟蹤恐慌 (#1203)

## ETC

- 設置賽普拉斯網絡的硬分叉區塊編號 (#1230)
 - 伊斯坦布爾 EVM 硬分叉：86816005
 - LondonEVM 硬分叉： 86816005
 - EthTxType 硬分叉： 86816005
- 為 Baobab 網絡設置硬分叉區塊編號 (#1230)
 - EthTxType 硬分叉： 86513895

# 有關硬分叉的注意事項

新版本預計會影響目前正在服務中的 Klaytn DApp，因此如果您是服務運營商或開發者，我們建議您同時閱讀《邁向以太坊等價性》系列 [#1](https://medium.com/klaytn/toward-ethereum-equivalence-1-introducing-klaytn-v1-8-0-971911be7ff9) [#2](https://medium.com/klaytn/toward-ethereum-equivalence-2-changes-in-precompiled-contract-addresses-a314d9db2927) [#3](https://medium.com/klaytn/toward-ethereum-equivalence-3-supporting-ethereum-apis-ab16f66008) [#4](https://medium.com/klaytn/toward-ethereum-equivalence-4-ethereum-transaction-types-a5aefb18e5bf) 以及以下說明。

## 針對 DApp 服務提供商

### 使用舊版智能合約時可能會出現 "Out of Gas "錯誤

IstanbulEVM 硬分叉 EVM 包括對操作碼氣體成本的更改（請參閱 [Klaytn v1.7.0 發行說明](https://github.com/klaytn/klaytn/releases/tag/v1.7.0) 中的 "協議升級功能"）。 如果您的合同有很多功能需要有限的燃氣成本（如後備），那麼燃氣成本的變化可能會導致 "用完燃氣"。 到目前為止，我們已經確定了繼承 OpenZeppelin 的 BaseAdminUpgradeabilityProxy.sol 和 BaseUpgradeabilityProxy.sol 的可升級合約實現與 Proxy.sol 相同的回退函數時的問題。 請檢查該功能是否以類似方式實現。 此外，請記住天然氣成本會不斷變化，因此除打印日誌外，請避免在備用設備中使用重負荷操作。 ([參考文獻](https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/))。

### 部分預編合同地址將被更改

將轉移 vmLog(0x09)、feePayer(0x0a)、validateSender(0x0b) 地址，以確保與以太坊預編譯合約的兼容性。 它只適用於硬分叉後部署的合約；硬分叉前部署的合約仍可繼續使用。 更多詳情，請參閱 [Toward Ethereum Equivalence #2 - Changes in Precompiled Contract Addresses](https://medium.com/klaytn/toward-ethereum-equivalence-2-changes-in-precompiled-contract-addresses-a314d9db2927)。

### 將您的 caver 更新至 v1.8.0 或更高版本，以支持新的交易類型

您將可以通過 `EthTxType` 硬分叉使用新的交易類型。 如果您的服務需要使用新的交易格式來訪問其他賬戶的交易，請確保將您的 caver 更新到 v1.8.0 ([js](https://www.npmjs.com/package/caver-js/v/1.8.0), [java](https://search.maven.org/artifact/com.klaytn.caver/core/1.8.0/jar)) 或更高版本。 有關新類型的更多詳情，請參閱 [Toward Ethereum Equivalence #4 - Ethereum 交易類型](https://medium.com/klaytn/toward-ethereum-equivalence-4-ethereum-transaction-types-a5aefb18e5bf)。

## 面向 EN 操作員

### eth "和 "klay "應用程序接口的新返回值

以前，您可以使用 `eth` 命名空間調用 API，其效果與 `klay` 命名空間相同。 但從 v1.8.0 開始，`eth` 命名空間 API 將採用以太坊 API 返回格式。 您可以在 [Toward Ethereum Equivalence #3 - Supporting Ethereum API formats](https://medium.com/klaytn/toward-ethereum-equivalence-3-supporting-ethereum-apis-ab16f66008) 中瞭解更多信息。 如果想沿用舊版本的行為，像使用 `klay` 那樣使用 `eth`，只需添加 `--rpc.eth.noncompatible` init 選項。

### 在 EN 的默認允許 API 列表中添加 \`eth

EN 支持 `eth` 命名空間 API，並將 `eth` 添加到默認允許列表中。 您需要將 `eth` 添加到 `kend.conf` 文件中的 `RPC_API` 和 `WS_API` 配置中，才能使用 `eth` API。 hardhat等以太坊工具使用的`net`、`web3`應用程序接口也被添加到了列表中。 總之，V1.8.0 中的默認 API 白名單包括RPC_API="klay,net,eth,web3"，WS_API="klay,net,eth,web3"
